#!/bin/bash
#Запуск регистрации.
#Вызов: runreg устройство частота усиление длина-записи пропускаемые период

f=$1    #rate
g=$2    #gain
l="$3"  #количество записываемых
t="$4"  #количество пропускаемых
p="$5"  #период трассы
if [ $f -ne 0 ]; then c=1; else c=0; fi # сжатие, если полоса не до 1600 
#($channels) 4 канала (0) тип оцифровки ($f) номер частоты
#($g) номер усиления ($t) количество пропускаемых ($l) количество записываемых
#(3 0 0 0) задержка регистрации 3 сек от синхроимпульса ($p) период трассы
#(0 0) тайм слот ($c) формат отсчётов
val="$channels 0 $f $g $t $l 3 0 0 0 $p 2 0 $c"
echo Запуск регистрации
run=`echo "2 2 $(hexsum $val) $val" | send2dev -d $dev -p $registr`
if [ $? -ne 0 ]; then
	echo Ошибка запуска регистрации
	exit 1
	#continue
fi

